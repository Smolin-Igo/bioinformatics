# Анализ GC-состава последовательностей ДНК из NCBI

**Описание:**

Этот скрипт предназначен для анализа GC-состава последовательностей ДНК, полученных из базы данных NCBI (National Center for Biotechnology Information). Он использует библиотеку `requests` для загрузки последовательностей FASTA по Accession Number, библиотеку `SciPy` для статистического анализа отклонения GC-состава от ожидаемого значения с использованием критерия хи-квадрат, и библиотеку `Matplotlib` для визуализации результатов.

**Функциональность:**

*   **Загрузка последовательностей FASTA:** Получение последовательностей ДНК из базы данных NCBI Nucleotide по Accession Number с использованием HTTP-запросов.
*   **Расчет GC-состава:** Вычисление процентного содержания гуанина (G) и цитозина (C) в последовательности ДНК.
*   **Статистический анализ:** Проверка статистической значимости отклонения GC-состава от ожидаемого значения (по умолчанию 50%) с помощью критерия хи-квадрат.
*   **Визуализация результатов:** Создание столбчатых диаграмм, отображающих наблюдаемый и ожидаемый GC-состав, статистическую значимость отклонения и длину последовательности.
*   **Сохранение графиков:** Сохранение сгенерированных графиков в файлы PNG для дальнейшего использования.

**Требования:**

*   Python 3.6 или выше
*   requests (установка: `pip install requests`)
*   scipy (установка: `pip install scipy`)
*   matplotlib (установка: `pip install matplotlib`)

**Использование:**

1.  **Установите необходимые библиотеки:**
    ```bash
    pip install requests scipy matplotlib
    ```
2.  **Загрузите скрипт** `gc_content_analyzer.py`
3.  **Укажите свой адрес электронной почты:** Откройте скрипт `gc_content_analyzer.py` и замените `"your_email@example.com"` на свой реальный адрес электронной почты в функции `get_fasta_from_ncbi`. NCBI требует указания email для идентификации пользователей.
4.  **Запустите скрипт:**
    ```bash
    python gc_content_analyzer.py
    ```

**Аргументы командной строки:**

Скрипт не принимает аргументы командной строки. Список Accession Numbers для анализа задается непосредственно в коде (в функции `main`).

**Вывод:**

Скрипт выводит в консоль результаты анализа для каждой последовательности, включая:

*   Идентификатор последовательности (header) и Accession Number.
*   Длину последовательности.
*   GC-состав (в процентах).
*   Статистику критерия хи-квадрат и p-значение.
*   Информацию о статистической значимости отклонения GC-состава от ожидаемого значения.

Кроме того, скрипт создает PNG файлы с графиками, отображающими GC-состав и статистическую значимость для каждой последовательности. Эти файлы сохраняются в той же директории, где находится скрипт.

**Функции:**

*   `get_fasta_from_ncbi(accession_number, email="your_email@example.com")`:
    *   Получает последовательность FASTA из NCBI по Accession Number.
    *   **Аргументы:**
        *   `accession_number` (str): Accession Number последовательности.
        *   `email` (str, optional): Ваш адрес электронной почты (необходимо для NCBI). Defaults to "your_email@example.com".
    *   **Возвращает:** Последовательность FASTA в виде строки, или `None` в случае ошибки.

*   `read_fasta_string(fasta_string)`:
    *   Читает FASTA формат из строки и возвращает словарь.
    *   **Аргументы:**
        *   `fasta_string` (str): FASTA формат в виде строки.
    *   **Возвращает:** Словарь, где ключи - это идентификаторы последовательностей, а значения - сами последовательности.

*   `calculate_gc_content(sequence)`:
    *   Рассчитывает GC-состав последовательности ДНК.
    *   **Аргументы:**
        *   `sequence` (str): Последовательность ДНК.
    *   **Возвращает:** GC-состав в процентах (float).

*   `calculate_nucleotide_counts(sequence)`:
    *   Рассчитывает количество каждого нуклеотида (A, C, G, T) в последовательности.
    *   **Аргументы:**
        *   `sequence` (str): Последовательность ДНК.
    *   **Возвращает:** Кортеж, содержащий количество A, C, G и T в последовательности.

*   `perform_chisquare_test(sequence, expected_gc=50.0)`:
    *   Проверяет GC-состав на отклонение от ожидаемого значения с помощью критерия хи-квадрат.
    *   **Аргументы:**
        *   `sequence` (str): Последовательность ДНК.
        *   `expected_gc` (float, optional): Ожидаемый GC-состав (в процентах). Defaults to 50.0.
    *   **Возвращает:** Кортеж, содержащий: статистику хи-квадрат, p-значение, наблюдаемый GC-состав, ожидаемый GC-состав и длину последовательности.

*   `visualize_gc_content(header, accession_number, observed_gc, expected_gc, statistic, p_value, length)`:
    *   Визуализирует GC-состав с пометками о статистической значимости и длине последовательности.
    *   **Аргументы:**
        *   `header` (str): Идентификатор последовательности.
        *   `accession_number` (str): Accession Number последовательности.
        *   `observed_gc` (float): Наблюдаемый GC-состав (в процентах).
        *   `expected_gc` (float): Ожидаемый GC-состав (в процентах).
        *   `statistic` (float): Статистика критерия хи-квадрат.
        *   `p_value` (float): p-значение критерия хи-квадрат.
        *   `length` (int): Длина последовательности.

*   `main()`:
    *   Основная функция скрипта.
    *   Загружает последовательности FASTA, рассчитывает GC-состав, проводит статистический анализ и визуализирует результаты.

**Примеры использования:**

1.  Запустите скрипт, чтобы проанализировать GC-состав последовательностей, определенных в списке `accession_numbers` функции `main()`:
    ```bash
    python gc_content_analyzer.py
    ```
2.  Измените список `accession_numbers` в функции `main()`, чтобы проанализировать другие последовательности.
3.  Измените значение `expected_gc` в функции `perform_chisquare_test()`, чтобы использовать другое ожидаемое значение GC-состава. *Помните, что 50% - это упрощенное предположение, и для корректного анализа следует использовать биологически обоснованное значение, если оно известно.*

**Ограничения:**

*   Скрипт загружает последовательности FASTA из NCBI по одной. Для анализа большого количества последовательностей может потребоваться оптимизация (например, использование многопоточности).
*   Критерий хи-квадрат использует упрощенное предположение о том, что ожидаемый GC-состав равен 50%. Для корректного анализа следует использовать биологически обоснованное значение, если оно известно.
*   Скрипт не обрабатывает ошибки, связанные с сетевым подключением или недоступностью базы данных NCBI.

**Дальнейшие улучшения:**

*   Добавить возможность чтения Accession Numbers из файла.
*   Реализовать многопоточную загрузку последовательностей.
*   Добавить возможность выбора различных статистических тестов.
*   Реализовать более сложные методы визуализации данных.
*   Добавить возможность указания ожидаемого GC-состава в качестве аргумента командной строки.

**Важные замечания:**

*   Не злоупотребляйте сервисом NCBI. Соблюдайте ограничения на количество запросов и указывайте свой адрес электронной почты при каждом запросе.
*   Интерпретируйте результаты анализа с осторожностью, учитывая биологический контекст.